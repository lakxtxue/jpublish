<?xml version="1.0" encoding="UTF-8"?>
<!-- This is the buildfile that can be used either from the command line or from IntelliJ -->
<project default="test">

    <target name="clean">
        <delete dir="build"/>
    </target>

    <path id="libs">
        <fileset dir="lib">
            <include name="**/*.jar"/>
        </fileset>
    </path>

    <target name="compile">
        <mkdir dir="build/classes"/>
        <javac srcdir="src" destdir="build/classes" classpathref="libs" debug="yes" verbose="yes" target="1.4"/>
    </target>

    <target name="jar" depends="compile">
        <jar destfile="build/newforms.jar" basedir="build/classes"/>
    </target>

    <target name="compile_tests" depends="jar">
        <mkdir dir="build/testclasses"/>
        <javac srcdir="test" destdir="build/testclasses" debug="yes" verbose="yes" target="1.4">
            <classpath>
                <path refid="libs"/>
                <pathelement location="build/newforms.jar"/>
            </classpath>
        </javac>
    </target>

    <target name="test" depends="compile_tests">
        <java fork="yes" classname="junit.textui.TestRunner">
            <arg value="org.jpublish.newforms.CharFieldTest"/>
            <classpath>
                <pathelement location="build/testclasses"/>
                <path refid="libs"/>
                <pathelement location="build/newforms.jar"/>
            </classpath>
        </java>
    </target>

</project>
